import { useRefEvent } from 'reev/react'

# How to make Drag Gesture

[demo][demo]

[demo]: https://codesandbox.io/s/draggable-test-forked-ftlr8u

## create your App

```tsx
import { createRoot } from 'react-dom/client'
import { useDrag } from './reev'
import { gsap } from 'gsap'
import './styles.css'

function App({ children }: { children?: React.ReactNode }) {
        const ref = useDrag((self) => {
                const {
                        active,
                        offset: [x, y],
                        target,
                } = self
                gsap.to(target, { x, y, scale: active ? 1.2 : 1 })
        })
        return <span ref={ref}>{children}</span>
}

createRoot(document.getElementById('root')!).render(<App />)
```

## crate useDrag

```ts
import { useRefEvent } from './hooks'

const addV = (a, b) => [a[0] + b[0], a[1] + b[1]]
const subV = (a, b) => [a[0] - b[0], a[1] - b[1]]

export function useDrag(onDrag) {
        const self = useRefEvent<DragState>({
                onDrag,
                move(e) {
                        self._active = self.active
                        self._value = self.value
                        self.value = [e.clientX, e.clientY]
                        if (self._active) {
                                self.delta = subV(self.value, self._value)
                                self.offset = addV(self.offset, self.delta)
                                self.movement = addV(self.movement, self.delta)
                        }
                        self('onDrag', self)
                },
                down(e) {
                        self.event = e
                        self._active = false
                        self.active = true
                        self.target.setPointerCapture(e.pointerId)
                        self('onDrag', self)
                },
                up(e) {
                        self.event = e
                        self._active = true
                        self.active = false
                        self.delta = [0, 0]
                        self.movement = [0, 0]
                        self.target.releasePointerCapture(e.pointerId)
                        self('onDrag', self)
                },
                mount(target) {
                        self.target = target
                        self.active = false
                        self._active = false
                        self.value = [0, 0]
                        self._value = [0, 0]
                        self.delta = [0, 0]
                        self.offset = [0, 0]
                        self.movement = [0, 0]
                        target.addEventListener('pointermove', self.on('move'))
                        target.addEventListener('pointerdown', self.on('down'))
                        target.addEventListener('pointerleave', self.on('up'))
                        target.addEventListener('pointerup', self.on('up'))
                },
                clean(target) {
                        target.removeEventListener('pointermove', self.on('move'))
                        target.removeEventListener('pointerdown', self.on('down'))
                        target.removeEventListener('pointerleave', self.on('up'))
                        target.removeEventListener('pointerup', self.on('up'))
                },
        })

        return self.on('ref')
}
```

# How to use orientation

## create your app

```ts
import { Mobile } from '@site/ui/Mobile'

export const App = () => {
        const [alpha, beta, gamma] = useOrientation()
        return <Mobile alpha={alpha} beta={beta} gamma={gamma} />
}
```

import { Mobile } from '@site/ui/Mobile'

export const App = () => {
        const [alpha, beta, gamma] = useOrientation()
        return <Mobile alpha={alpha} beta={beta} gamma={gamma} />
}

<App />

## create orientation event

```ts
import { event } from 'reev'
import { useSyncExternalStore } from 'react'

export const addV = (a, b) => [a[0] + b[0], a[1] + b[1], a[2] + b[2]]
export const subV = (a, b) => [a[0] - b[0], a[1] - b[1], a[2] - b[2]]

export const self = event({
        snapshot: [0, 0, 0],
        reset() {
                self.active = self._active = false
                self.value = self._value = [0, 0, 0]
                self.delta = self.offset = [0, 0, 0]
        },
        mount() {
                self.reset()
                self.active = true
                window.addEventListener('deviceorientation', self.callback)
        },
        clean() {
                self.reset()
                window.removeEventListener('deviceorientation', self.callback)
        },
        callback(e) {
                self._active = self.active
                self._value = self.value
                self.value = [90 - (e.alpha ?? 90), e.beta ?? 0, e.gamma ?? 0]
                if (self._active) {
                        self.delta = subV(self.value, self._value)
                        self.offset = addV(self.offset, self.delta)
                }
                self.snapshot = self.offset
        },
})
```

import { event } from 'reev'
import { useSyncExternalStore } from 'react'

export const addV = (a, b) => [a[0] + b[0], a[1] + b[1], a[2] + b[2]]
export const subV = (a, b) => [a[0] - b[0], a[1] - b[1], a[2] - b[2]]

export const self = event({
        snapshot: [0, 0, 0],
        reset() {
                self.active = self._active = false
                self.value = self._value = [0, 0, 0]
                self.delta = self.offset = [0, 0, 0]
        },
        mount() {
                self.reset()
                self.active = true
                window.addEventListener('deviceorientation', self.callback)
        },
        clean() {
                self.reset()
                window.removeEventListener('deviceorientation', self.callback)
        },
        callback(e) {
                self._active = self.active
                self._value = self.value
                self.value = [90 - (e.alpha ?? 90), e.beta ?? 0, e.gamma ?? 0]
                if (self._active) {
                        self.delta = subV(self.value, self._value)
                        self.offset = addV(self.offset, self.delta)
                }
                self.snapshot = self.offset
        },
})

## create useOrientation hook

```ts
export const subscribe = (callback) => {
        self({ callback }).mount()
        return () => self.clean()
}

export const getSnapshot = () => self.snapshot

export const getServerSnapshot = () => self.snapshot

export const useOrientation = () => {
        return useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot)
}
```

export const subscribe = (callback) => {
        self({ callback }).mount()
        return () => self.clean()
}

export const getSnapshot = () => self.snapshot

export const getServerSnapshot = () => self.snapshot

export const useOrientation = () => {
        return useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot)
}

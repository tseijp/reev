# How to use battery

## create your app

```ts
import { Battery } from '@site/ui/Battery'

export const App = () => {
        const battery = useBattery()
        return <Battery level={battery?.level} charging={battery?.charging} />
}
```

import { Battery } from '@site/ui/Battery'

export const App = () => {
        const battery = useBattery()
        return <Battery level={battery?.level} charging={battery?.charging} />

}

<App />

## create battery event

```ts
import { event } from 'reev'
import { useSyncExternalStore } from 'react'

export const self = event({
        async change() {
                const battery = await navigator.getBattery()
                self.snapshot = {
                        level: battery.level,
                        charging: battery.charging,
                        chargingTime: battery.chargingTime,
                        dischargingTime: battery.dischargingTime,
                }
                self.callback()
        },
        mount() {
                self.change()
                navigator.getBattery().then((target) => {
                        self.target = target
                        target.addEventListener('levelchange', self.change)
                        target.addEventListener('chargingchange', self.change)
                })
        },
        clean() {
                self.target.removeEventListener('levelchange', self.change)
                self.target.removeEventListener('chargingchange', self.change)
        },
})
```

import { event } from 'reev'
import { useSyncExternalStore } from 'react'

export const self = event({
        async change() {
                const battery = await navigator.getBattery()
                self.snapshot = {
                        level: battery.level,
                        charging: battery.charging,
                        chargingTime: battery.chargingTime,
                        dischargingTime: battery.dischargingTime,
                }
                self.callback()
        },
        mount() {
                self.change()
                navigator.getBattery().then((target) => {
                        self.target = target
                        target.addEventListener('levelchange', self.change)
                        target.addEventListener('chargingchange', self.change)
                })
        },
        clean() {
                self.target.removeEventListener('levelchange', self.change)
                self.target.removeEventListener('chargingchange', self.change)
        },
})

## create useBattery hook

```ts
export const subscribe = (callback) => {
        self({ callback }).mount()
        return () => self.clean()
}

export const getSnapshot = () => self.snapshot

export const getServerSnapshot = () => void 0

export const useBattery = () => {
        return useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot)
}
```

export const subscribe = (callback) => {
        self({ callback }).mount()
        return () => self.clean()
}

export const getSnapshot = () => self.snapshot

export const getServerSnapshot = () => void 0

export const useBattery = () => {
        return useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot)
}

# How to use battery

## create your app

```ts
export const App = () => {
        const battery = useBattery()
        return <span>{battery?.level}</span>
}
```

export const App = () => {
        const battery = useBattery()
        return <span>{battery?.level}</span>
}

<App />

## create useBattery

```ts
import { event } from 'reev'
import { useSyncExternalStore } from 'react'

export const self = event({
        mount() {
                navigator.getBattery().then((target) => {
                        self.target = target
                        target.addEventListener('levelchange', self.callback)
                        target.addEventListener('chargingchange', self.callback)
                })
        },
        clean() {
                self.target.removeEventListener('levelchange', self.callback)
                self.target.removeEventListener('chargingchange', self.callback)
        },
})

export const getSnapShot = () => self.battery

export const subscribe = (callback) => {
        self('callback', async () => {
                const battery = await navigator.getBattery()
                self.battery = battery
                callback()
        })
        self.callback()
        self.mount()
        return () => self.clean()
}

export const useBattery = () => useSyncExternalStore(subscribe, getSnapShot)
```

import { event } from 'reev'
import { useSyncExternalStore } from 'react'

export const self = event({
        mount() {
                navigator.getBattery().then((target) => {
                        self.target = target
                        target.addEventListener('levelchange', self.callback)
                        target.addEventListener('chargingchange', self.callback)
                })
        },
        clean() {
                self.target.removeEventListener('levelchange', self.callback)
                self.target.removeEventListener('chargingchange', self.callback)
        },
})

export const getSnapShot = () => self.battery

export const subscribe = (callback) => {
        self('callback', async () => {
                const battery = await navigator.getBattery()
                self.battery = battery
                callback()
        })
        self.callback()
        self.mount()
        return () => self.clean()
}

export const useBattery = () => useSyncExternalStore(subscribe, getSnapShot)

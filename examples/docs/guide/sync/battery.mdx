# How to use battery

## create your app

```ts
export const App = () => {
        const battery = useBattery()
        return <span>{battery?.level}</span>
}
```

export const App = () => {
        const battery = useBattery()
        return <span>{battery?.level}</span>
}

<App />

## create battery event

```ts
import { event } from 'reev'
import { useSyncExternalStore } from 'react'

export const self = event({
        async change() {
                const snapshot = await navigator.getBattery()
                self.snapshot = snapshot
                self.callback()
        },
        mount() {
                self.change()
                navigator.getBattery().then((target) => {
                        self.target = target
                        target.addEventListener('levelchange', self.change)
                        target.addEventListener('chargingchange', self.change)
                })
        },
        clean() {
                self.target.removeEventListener('levelchange', self.change)
                self.target.removeEventListener('chargingchange', self.change)
        },
})
```

import { event } from 'reev'
import { useSyncExternalStore } from 'react'

export const self = event({
        async change() {
                const snapshot = await navigator.getBattery()
                self.snapshot = snapshot
                self.callback()
        },
        mount() {
                self.change()
                navigator.getBattery().then((target) => {
                        self.target = target
                        target.addEventListener('levelchange', self.change)
                        target.addEventListener('chargingchange', self.change)
                })
        },
        clean() {
                self.target.removeEventListener('levelchange', self.change)
                self.target.removeEventListener('chargingchange', self.change)
        },
})

## create useBattery hook

```ts
export const subscribe = (callback) => {
        self({ callback }).mount()
        return () => self.clean()
}

export const getSnapshot = () => self.snapshot

export const getServerSnapshot = () => void 0

export const useBattery = () => {
        return useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot)
}
```

export const subscribe = (callback) => {
        self({ callback }).mount()
        return () => self.clean()
}

export const getSnapshot = () => self.snapshot

export const getServerSnapshot = () => void 0

export const useBattery = () => {
        return useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot)
}

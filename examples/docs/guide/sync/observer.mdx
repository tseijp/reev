# How to use observer

## create your app

```ts
export const App = () => {
        const [entry, ref] = useObserver()
        console.log(entry)
        return (
                <div ref={ref}>
                        <div>{entry?.isIntersecting ? 'ğŸ‘€' : 'ğŸ˜‘'}</div>
                </div>
        )
}
```

export const App = () => {
        const [entry, ref] = useObserver()
        console.log(entry)
        return (
                <div ref={ref}>
                        <div>{entry?.isIntersecting ? 'ğŸ‘€' : 'ğŸ˜‘'}</div>
                </div>
        )
}

<App />

## create useObserver

```ts
import { useRefEvent } from 'reev/react'
import { useSyncExternalStore, useCallback } from 'react'

export const useObserver = () => {
        const self = useRefEvent({
                mount(target) {
                        self.observer = new IntersectionObserver(self.callback)
                        self.observer.observe(target)
                },
                clean(target) {
                        delete self.observer
                },
                callback(entries) {
                        self.entry = entries.find(
                                (entry) => entry.target === self.target
                        )
                },
        })
        const subscribe = useCallback(
                (callback) => void self({ callback }),
                [self]
        )
        return [useSyncExternalStore(subscribe, () => self.entry), self.ref]
}
```

import { useRefEvent } from 'reev/react'
import { useSyncExternalStore, useCallback } from 'react'

export const useObserver = () => {
        const self = useRefEvent({
                mount(target) {
                        self.observer = new IntersectionObserver(self.callback)
                        self.observer.observe(target)
                },
                clean(target) {
                        delete self.observer
                },
                callback(entries) {
                        self.entry = entries.find(
                                (entry) => entry.target === self.target
                        )
                },
        })
        const subscribe = useCallback(
                (callback) => void self({ callback }),
                [self]
        )
        return [useSyncExternalStore(subscribe, () => self.entry), self.ref]
}

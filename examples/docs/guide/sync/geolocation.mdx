# How to use geolocation

## create your app

```ts
export const App = () => {
        const { coords = {} } = useGeolocation()
        return (
                <div>
                        <div>latitude: {coords.latitude}</div>
                        <div>longitude: {coords.longitude}</div>
                        <div>accuracy: {coords.accuracy}</div>
                </div>
        )
}
```

export const App = () => {
        const { coords = {} } = useGeolocation()
        return (
                <div>
                        <div>latitude: {coords.latitude}</div>
                        <div>longitude: {coords.longitude}</div>
                        <div>accuracy: {coords.accuracy}</div>
                </div>
        )
}

<App />

## create geolocation event

```ts
import { event } from 'reev'
import { useSyncExternalStore } from 'react'

export const self = event({
        change() {
                navigator.geolocation.getCurrentPosition((position) => {
                        self.snapshot = position
                        self.callback()
                })
        },
        mount() {
                self.change()
                self.id = navigator.geolocation.watchPosition(self.change)
        },
        clean() {
                if (self.id) navigator.geolocation.clearWatch(self.id)
        },
})
```

import { event } from 'reev'
import { useSyncExternalStore } from 'react'

export const self = event({
        change() {
                navigator.geolocation.getCurrentPosition((position) => {
                        self.snapshot = position
                        self.callback()
                })
        },
        mount() {
                self.change()
                self.id = navigator.geolocation.watchPosition(self.change)
        },
        clean() {
                if (self.id) navigator.geolocation.clearWatch(self.id)
        },
})

## create useGeolocation hook

```ts
export const subscribe = (callback) => {
        self({ callback }).mount()
        return () => self.clean()
}

export const getSnapshot = () => self.snapshot || {}

export const getServerSnapshot = () => ({})

export const useGeolocation = () => {
        return useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot)
}
```

export const subscribe = (callback) => {
        self({ callback }).mount()
        return () => self.clean()
}

export const getSnapshot = () => self.snapshot || {}

export const getServerSnapshot = () => ({})

export const useGeolocation = () => {
        return useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot)
}
